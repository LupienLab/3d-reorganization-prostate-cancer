import pandas as pd
import os.path as path

# ==============================================================================
# Configuration
# ==============================================================================
CONFIG = pd.read_csv('config.tsv', index_col=False, sep='\t')
ACCESSIONS = CONFIG['Accession'].tolist()

# ==============================================================================
# Meta Rules
# ==============================================================================
rule all:
    input:
        'rulegraph.png',
        'ENCFF925XUX.tdf',
        'ENCFF265TUU.tdf',
        'ENCFF500VJD.tdf',
        'ENCFF117GZZ.tdf',
        'ENCFF292WTB.bigBed',
        'ENCFF700QXT.bigBed',
        'ENCFF058ZMC.bigBed',
        'ENCFF957KCI.bigBed'

rule rulegraph:
    output:
        'rulegraph.png',
    shell:
        'snakemake --rulegraph | dot -Tpng > {output}'

# ==============================================================================
# Rules
# ==============================================================================
# there is no rule to download files since ENCODE uses AWS for a backend, and
# the URLs listed on ENCODE's pages aren't the exact download links

rule bam_to_tdf:
    input:
        '{acn}.bam'
    output:
        '{acn}.tdf'
    shell:
        'igvtools count {input} {output} hg38'
