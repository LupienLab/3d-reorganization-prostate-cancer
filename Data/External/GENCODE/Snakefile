# ==============================================================================
# Meta Rules
# ==============================================================================
rule all:
    input:
        "gencode.v33.genes.sorted.bed",
        "gencode.v33.tss.sorted.bed",

# ==============================================================================
# Rules
# ==============================================================================
rule download_annotation:
    output:
        temp("gencode.v33.annotation.gtf.gz")
    shell:
        "curl -O ftp://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_33/gencode.v33.annotation.gtf.gz"

rule filter:
    input:
        script = "filter-gencode.R",
        data = "gencode.v33.annotation.gtf"
    output:
        "gencode.v33.genes.bed",
        "gencode.v33.tss.bed",
    shell:
        "Rscript {input.script}"

rule sort:
    input:
        "{file}.bed"
    output:
        "{file}.sorted.bed"
    shell:
        "sort -k 1,1 -V -k2,2n {input} > {output}"
