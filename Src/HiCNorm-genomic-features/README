The pipeline to create "all*" files follows four steps:
[1] restriction_cuts.pl - Usage: Please give the <ref_genome> <fai file> <6base cut sequence>
	The code works only for a 6 base cutter and takes in the reference genome, reference genome fasta index and 6 base cut sequence (such as AAGCTT for Hind3). It provides an output file that has 6 columns. 
	Col 1 - Restriction Fragment ID
	Col 2 - Direction of Fragment: '-' upstream of cut site and '+' being downstream of cut site.
	Col 3 - Chromosome
	Col 4 - Position of the Cut site
	Col 5 - Restriction Fragment Length
	Col 6 - GC Content
	
The output file of this step (all*.F_GC file) is a temporary file which is further used in step 2, 3 and 4 to create the "all*.F_GC_M" file required by our Poisson and Yaffe and Tanay's methods of normalization.

The first step generated the positions of cut sites and its properties such as GC content and fragment length. The GC content is calculated as the fraction of G/C bases in 200 bases of the fragment from the cut site. Our next step is to estimate mappability for every fragment. To generate mappability, we simulate artificial reads and then align them. 

[2] fastq_from_loc.pl - Usage: ./fastq_from_loc.pl <fasta file> <all*.F_GC file>
The code takes in reference genome fasta file and the all*.F_GC file to obtain reads along a given restriction fragment. Briefly, for every restriction fragment, we produce 55 reads (each read is 36bp) by taking 500bp from the cut site. The output of this step produces fastq file. The fastq file has the read position in its header sequence for validation.

[3] The fastq file produced from step 2 is aligned by your favorite aligner. We use BWA. However, any aligner will work. Please output the mapping format as a sam file.

[4] sam_processer.pl - Usage: Please provide <all*.F_GC file> <fastq_file> and <sam_output>
	The script takes in output from step 1, 2 and 3 in that order and makes the final "all*" file that includes 9 columns
        Col 1 - Restriction Fragment ID
        Col 2 - Direction of Fragment: '-' upstream of cut site and '+' being downstream of cut site.
        Col 3 - Chromosome
        Col 4 - Position of the Cut site
        Col 5 - Restriction Fragment Length
        Col 6 - GC Content
	Col 7 - Mappability X (No of Reads mapped)
	Col 8 - Total Reads (55)
	Col 9 - Mappability Score - X/55.
